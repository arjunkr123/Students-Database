<style type='text/css'>
.transcripts {
	font-family: Verdana;
	padding:10px 20px;
	background-color: white;
}
.transcripts .title {
	font-size:22pt;
}
.transcripts .student_information {
	width: 100%;
	margin-top:10px;
	margin-bottom: 10px;
}
.transcripts .grades {
	table-layout: fixed;
	empty-cells: hide;
	width: 100%;
	border-spacing: 0px;
	border-collapse: collapse;
	margin-top: 2px;
}
.transcripts .grades.total {
	margin-top: 8px;
}
.transcripts .grades td {
	border: 2px solid black;
}
.transcripts .grades .grade {
	padding: 0px;
}
.transcripts .grades td.blank, .transcripts .grades .total td.blank {
	border: none;
	background-color: white;
}
.transcripts .grades .title {
	background-color: #COLUMNS_TITLES_BACKGROUND#;
	color: #COLUMNS_TITLES_COLOR#;
	font-weight: #COLUMNS_TITLES_WEIGHT#;
	font-size: #COLUMNS_TITLES_SIZE#pt;
	text-align: center;
}
.transcripts .grades .subject_category {
	color: #SUBJECT_CATEGORY_COLOR#;
	font-weight: #SUBJECT_CATEGORY_WEIGHT#;
	font-size: #SUBJECT_CATEGORY_SIZE#pt;
	padding-top: 10px;
	-moz-transform: rotate(-90deg);
	-webkit-transform: rotate(-90deg);
	-o-transform: rotate(-90deg);
	transform: rotate(-90deg);
}
.transcripts .grades .subject_category_col {
	width: 24pt;
}
.transcripts .grades .subject_name_col {
}
.transcripts .grades .grade_col {
	width: 55px;
}
.transcripts .grades .info_col {
	width: 45px;
}
.transcripts .grades .subject_row {
	height: 20px;
}
.transcripts .grades .total {
}
.transcripts .grades .total>td:nth-child(2) {
	font-size: #TOTAL_SIZE#pt;
	font-weight: bold;
}
.transcripts .grades .total>td {
	background-color: #TOTAL_BACKGROUND#;
	color: #TOTAL_COLOR#;
	font-size: #TOTAL_SIZE#pt;
	font-weight: normal;
}
.transcripts td.subject_name {
	text-align: left;
	height: 24px;
}
.transcripts td {
	text-align: center;
	background-color: white;
}
.transcripts td.comment {
	font-size: 8pt;
}
.transcripts .grades tr.total>td:first-child {
	text-align: left;
	padding-left: 5px;
}
.transcripts .student_information .name {
	font-weight: bold;
}
.transcripts .general_appreciation {
	border: 2px solid black;
	margin-top: 8px;
}
.transcripts .general_appreciation th {
	font-size: #GENERAL_COMMENT_TITLE_SIZE#pt;
	font-weight: #GENERAL_COMMENT_TITLE_WEIGHT#;
	border-bottom: 2px solid black;
	text-align: center;
}
.transcripts .general_appreciation td {
	display: flex;
	align-items: center;
	justify-content: center;
	min-height: 55px;
	font-size: #GENERAL_COMMENT_SIZE#pt;
}
.transcripts .signature {
	font-size: 11pt;
	padding-left: 30px;
	margin-top: 10px;
}
</style>
<div class='transcripts' id='#ID#'>
<!-- Header / Title -->
<div class='title'>
	<div style='display:inline-block;width:120px'>
	<img src='/static/application/logo.png' width=70 height=70 style='vertical-align:top;'/>
	</div>
	<div style='display:inline-block;width:450px;vertical-align:top'>
		OFFICIAL TRANSCRIPT OF ACADEMIC RECORDS
	</div>
</div>
<!-- Student's information -->
<table class='student_information'>
	<tr>
		<td>First Name:</td>
		<td class='name'>#First Name#</td>
		<td>Last Name:</td>
		<td class='name'>#Last Name#</td>
	</tr>
	<tr>
		<td>Academic Period:</td>
		<td>#Academic Period#</td>
		<td>Date:</td>
		<td>#Academic Period Date#</td>
	</tr>
</table>
<!-- Grades -->
#SUBJECT_CATEGORY#
<table class='grades'>
	<colgroup>
		<col class='subject_category_col'/>
		<col class='subject_name_col'/>
		#IF:nb_hours#<col class='info_col'/>#ENDIF#
		#IF:coefficient#<col class='info_col'/>#ENDIF#
		<col class='grade_col'/>
		#IF:class_average#<col class='grade_col'/>#ENDIF#
		#IF:comment#<col class='comment_col'/>#ENDIF#
	</colgroup>
	<tbody>
	#IF:SUBJECT_CATEGORY[0]#
	<tr>
		<td class='blank'></td>
		<td class='title'><div>Subject</div></td>
		#IF:nb_hours#<td class='title'><div>Hrs</div></td>#ENDIF#
		#IF:coefficient#<td class='title'><div>Coef.</div></td>#ENDIF#
		<td class='title'><div>Grade</div></td>
		#IF:class_average#<td class='title'><div>Class<br/>Avg</div></td>#ENDIF#
		#IF:comment#<td class='title'><div>Comment</div></td>#ENDIF#
	</tr>
	#ENDIF#
	#SUBJECT#
	<tr class='subject_row'>
		#IF:SUBJECT[0]#<td rowspan="#COUNT(SUBJECTS)#" style='white-space:nowrap;background-color:#SUBJECT_CATEGORY_BACKGROUND#;'><div class='subject_category' style='display:inline-block'>#SUBJECT_CATEGORY_NAME#</div></td>#ENDIF#
		<td class='subject_name'>#SUBJECT_NAME#</td>
		#IF:nb_hours#<td class='info'>#SUBJECT_HOURS#</td>#ENDIF#
		#IF:coefficient#<td class='info'>#SUBJECT_COEFFICIENT#</td>#ENDIF#
		<td style='position:relative' class='grade'>#GRADE#</td>
		#IF:class_average#<td class='grade'>#CLASS_AVERAGE#</td>#ENDIF#
		#IF:comment#<td class='comment'>#COMMENT#</td>#ENDIF#
	</tr>
	#END_SUBJECT#
	<tr class='total'>
		<td class='blank'></td>
		<td>Total</td>
		#IF:nb_hours#<td>#TOTAL_HOURS#</td>#ENDIF#
		#IF:coefficient#<td>#TOTAL_COEFFICIENT#</td>#ENDIF#
		<td>#TOTAL_GRADE#</td>
		#IF:class_average#<td>#TOTAL_CLASS_AVERAGE#</td>#ENDIF#
		#IF:comment#<td></td>#ENDIF#
	</tr>
	</tbody>
</table>
#END_SUBJECT_CATEGORY#
#SINGLE_SUBJECT#
<table class='grades' style='margin-top:10px'>
		<col class='subject_name_col'/>
		#IF:nb_hours#<col class='info_col'/>#ENDIF#
		#IF:coefficient#<col class='info_col'/>#ENDIF#
		<col class='grade_col'/>
		#IF:class_average#<col class='grade_col'/>#ENDIF#
	</colgroup>
	<tbody>
	<tr class='subject_row'>
		<td class='subject_name'>#CATEGORY_NAME# - #SUBJECT_NAME#</td>
		#IF:nb_hours#<td class='info'>#SUBJECT_HOURS#</td>#ENDIF#
		#IF:coefficient#<td class='info'>#SUBJECT_COEFFICIENT#</td>#ENDIF#
		<td style='position:relative' class='grade'>#GRADE#</td>
		#IF:class_average#<td class='grade'>#CLASS_AVERAGE#</td>#ENDIF#
	</tr>
	</tbody>
</table>
#END_SINGLE_SUBJECT#
<!-- Global results -->
<table class='grades total'>
	<colgroup>
		<col/>
		<col class='grade_col'/>
		#IF:class_average#<col class='grade_col'/>#ENDIF#
	</colgroup>
	<tr class='total'>
		<td>Global Grade Point Average</td>
		<td>#GLOBAL_GRADE#</td>
		#IF:class_average#<td>#GLOBAL_CLASS_AVERAGE_GRADE#</td>#ENDIF#
	</tr>
</table>
<!-- General appreciation -->
#IF:general_appreciation#
<table class='general_appreciation' style='width:100%;border-spacing:0px;'>
	<tr><th style='background-color:#GENERAL_COMMENT_TITLE_BACKGROUND#;color:#GENERAL_COMMENT_TITLE_COLOR#'>General Appreciation</th></tr>
	<tr><td>
	<div>#General Appreciation#</div>
	</td></tr>
</table>
#ENDIF#
<!-- Signature -->
<div class='signature'>
	#Location#
	#Signatory Name#
	#Signatory Title#
</div>
</div>
<script type='text/javascript'>
function init_transcript_#ID#() {
	var cats = document.getElementById('#ID#').getElementsByClassName("subject_category");
	var enlarge = false;
	var max_height = 0;
	for (var i = 0; i < cats.length; ++i) {
		if (cats[i].hasAttribute("enlarge")) continue;
		var tbody = cats[i].parentNode.parentNode.parentNode;
		var nb_subjects = 0;
		for (var j = 0; j < tbody.childNodes.length; ++j) if (tbody.childNodes[j].nodeType == 1) nb_subjects++;
		nb_subjects -= 1+(i==0?1:0); // remove header and footer
		cats[i]._w = cats[i].offsetHeight;
		var size = cats[i].offsetWidth+10;
		if (size > nb_subjects * 24) {
			cats[i].style.whiteSpace = "normal";
			cats[i].style.paddingTop = "0px";
			enlarge = true;
			size = cats[i].offsetWidth;
			var fs = #SUBJECT_CATEGORY_SIZE#;
			if (size > nb_subjects*28-2) {
				while (size > nb_subjects*28-2 && fs > 8) {
					cats[i].style.fontSize = (--fs)+"pt";
					size = cats[i].offsetWidth;
				}
			}
			if (cats[i].offsetHeight > max_height) max_height = cats[i].offsetHeight;
			cats[i].style.marginLeft = (0-fs)+"pt";
			cats[i].setAttribute("enlarge",true);
		} else {
			if (cats[i].offsetHeight > max_height) max_height = cats[i].offsetHeight;
			cats[i].style.height = size+"px";
		}
	}
	if (enlarge) {
		var cols = document.getElementsByClassName("subject_category_col");
		for (var i = 0; i < cols.length; ++i)
			cols[i].style.width = max_height+"px";
		for (var i = 0; i < cats.length; ++i)
			if (!cats[i].hasAttribute("enlarge"))
				cats[i].style.marginLeft = (#SUBJECT_CATEGORY_SIZE#/2)+"pt";
	}	
}
init_transcript_#ID#();
</script>